<script>
    const ctx = document.getElementById('myChart');
    const data = {
        labels: <%= raw @categories_by_c.to_json.html_safe %>,
        datasets: [{
            label: 'Report by categories',
            data: <%= @amount_by_c.to_json.html_safe %>,
            backgroundColor: [
                'rgb(255, 99, 132)',
                'rgb(54, 162, 235)',
                'rgb(255, 205, 86)',
                'rgb(255, 87, 51)',
                'rgb(124, 252, 0)',
            ],
            hoverOffset: 4
        }]
    };

    const config = {
        type: 'doughnut',
        data: data,
        options: {
            responsive: false
        }
    };

    const myChart = new Chart(ctx, config);

    const urlParams = new URLSearchParams(window.location.search);
    const startDate = urlParams.get('startDate');
    const endDate = urlParams.get('endDate');

    document.title = `Report by category (${startDate} - ${endDate})`;

    document.getElementById('reportTitle').innerHTML = `Report by category (${startDate} - ${endDate})`;

    const reportTypeButtons = document.getElementsByName('report_type');
    const clearButton = document.getElementsByName('clear_button')[0];

    reportTypeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const reportType = this.value;
            const url = `/${reportType}?startDate=${startDate}&endDate=${endDate}`;
            window.location.href = url;
        });
    });

    clearButton.addEventListener('click', function() {
        const url = `/reports/index`;
        window.location.href = url;
    });
</script>
